<!DOCTYPE html>
<html>
  <head>
    <title>Tube'NPlay - Shorts</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover,minimal-ui">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <%= favicon_link_tag "logo/Copilot_20251006_162220.png" %>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
    <%= javascript_include_tag "application", "data-turbo-track": "reload" %>
    
    <style>
      :root {
        --bottom-gap: calc(env(safe-area-inset-bottom, 0px) + 60px) !important;
        --url-bar-height: 60px !important;
      }
      
      /* Ligne de référence pour marquer la limite de l'URL */
      .url-limit-line {
        position: fixed !important;
        bottom: var(--url-bar-height) !important;
        left: 0 !important;
        right: 0 !important;
        height: 2px !important;
        background: linear-gradient(90deg, red, orange, yellow, green, blue, indigo, violet) !important;
        z-index: 99999 !important;
        pointer-events: none !important;
        box-shadow: 0 0 10px rgba(255,255,255,0.8) !important;
      }
      
      /* Cibler la div background spécifique pour définir la limite */
      div[data-v-0473de6c].background {
        position: relative !important;
        z-index: 0 !important;
      }
      
      /* Ajuster la vidéo pour s'arrêter au niveau de cette div */
      .shorts-video,
      .shorts-video iframe,
      #youtube-iframe,
      iframe {
        max-height: calc(100vh - var(--bottom-gap)) !important;
        max-height: calc(100dvh - var(--bottom-gap)) !important;
        max-height: calc(100svh - var(--bottom-gap)) !important;
      }
      /* Reset COMPLET - Override tout */
      * {
        margin: 0 !important;
        padding: 0 !important;
        box-sizing: border-box !important;
        border: none !important;
        outline: none !important;
      }
      
      html {
        width: 100vw !important;
        height: 100vh !important;
        height: 100dvh !important;
        height: 100svh !important;
        overflow: hidden !important;
        background: #000 !important;
        margin: 0 !important;
        padding: 0 !important;
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        z-index: 99999 !important;
        font-size: 16px !important;
        -webkit-text-size-adjust: 100% !important;
        -ms-text-size-adjust: 100% !important;
      }
      
      body {
        width: 100vw !important;
        height: 100vh !important;
        height: 100dvh !important;
        height: 100svh !important;
        overflow: hidden !important;
        background: #000 !important;
        color: white !important;
        margin: 0 !important;
        padding: 0 !important;
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        z-index: 99999 !important;
        -webkit-overflow-scrolling: touch;
        overscroll-behavior: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        font-family: system-ui, -apple-system, sans-serif !important;
        -webkit-text-size-adjust: 100% !important;
        -ms-text-size-adjust: 100% !important;
        touch-action: none !important;
      }
      
      /* Masquer TOUS les éléments de navigation et layout */
      nav, .nav, .main-content, .flash, header, footer, .header, .footer {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        height: 0 !important;
        width: 0 !important;
        margin: 0 !important;
        padding: 0 !important;
      }
      
      /* Forcer le plein écran ABSOLU - Version mobile ultra-optimisée */
      .shorts-container,
      .results-container,
      .reward-results-container,
      .new-game-container,
      .play-container {
        width: 100vw !important;
        height: 100vh !important;
        height: 100dvh !important; /* Dynamic viewport height */
        height: 100svh !important; /* Small viewport height */
        height: 100lvh !important; /* Large viewport height */
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        z-index: 99999 !important;
        margin: 0 !important;
        padding: 0 !important;
        border-radius: 0 !important;
        box-shadow: none !important;
        max-width: none !important;
        max-height: none !important;
        background: #000 !important;
        display: flex !important;
        justify-content: center !important;
        align-items: center !important;
        transform: translateZ(0) !important;
        will-change: transform !important;
        touch-action: none !important;
        -webkit-touch-callout: none !important;
        -webkit-tap-highlight-color: transparent !important;
        overflow-y: auto !important;
      }

      /* Conteneur vidéo - S'arrêter exactement au-dessus de la ligne URL */
      .shorts-video {
        width: 100vw !important;
        height: calc(100svh - var(--url-bar-height)) !important;
        height: calc(100dvh - var(--url-bar-height)) !important;
        height: calc(100vh - var(--url-bar-height)) !important;
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
        overflow: hidden !important;
        z-index: 1 !important;
      }

      /* Styles ultra-agressifs pour forcer le plein écran - S'arrêter à la ligne URL */
      .shorts-video iframe,
      #youtube-iframe,
      iframe {
        width: 100vw !important;
        height: calc(100svh - var(--url-bar-height)) !important;
        height: calc(100dvh - var(--url-bar-height)) !important;
        height: calc(100vh - var(--url-bar-height)) !important;
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: var(--url-bar-height) !important;
        border: none !important;
        margin: 0 !important;
        padding: 0 !important;
        max-width: none !important;
        max-height: calc(100svh - var(--url-bar-height)) !important;
        max-height: calc(100dvh - var(--url-bar-height)) !important;
        max-height: calc(100vh - var(--url-bar-height)) !important;
        min-width: 100vw !important;
        min-height: calc(100svh - var(--url-bar-height)) !important;
        min-height: calc(100dvh - var(--url-bar-height)) !important;
        min-height: calc(100vh - var(--url-bar-height)) !important;
        transform: scale(2) !important;
        object-fit: cover !important;
        z-index: 1 !important;
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
      }

      /* Forcer tous les éléments iframe - S'arrêter à la ligne URL */
      iframe[src*="youtube"] {
        width: 100vw !important;
        height: calc(100svh - var(--url-bar-height)) !important;
        height: calc(100dvh - var(--url-bar-height)) !important;
        height: calc(100vh - var(--url-bar-height)) !important;
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: var(--url-bar-height) !important;
        border: none !important;
        margin: 0 !important;
        padding: 0 !important;
        max-width: none !important;
        max-height: calc(100svh - var(--url-bar-height)) !important;
        max-height: calc(100dvh - var(--url-bar-height)) !important;
        max-height: calc(100vh - var(--url-bar-height)) !important;
        min-width: 100vw !important;
        min-height: calc(100svh - var(--url-bar-height)) !important;
        min-height: calc(100dvh - var(--url-bar-height)) !important;
        min-height: calc(100vh - var(--url-bar-height)) !important;
        transform: scale(2) !important;
        z-index: 1 !important;
      }

      /* Contrôles et overlay - Positionnés au-dessus de la ligne URL */
      .shorts-controls {
        position: fixed !important;
        bottom: calc(var(--url-bar-height) + 20px) !important;
        left: 0 !important;
        right: 0 !important;
        background: linear-gradient(transparent, rgba(0,0,0,0.8)) !important;
        padding: 20px !important;
        z-index: 9999 !important;
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
        pointer-events: auto !important;
      }

      .shorts-info {
        margin-bottom: 20px !important;
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
      }

      .shorts-info h2 {
        color: white !important;
        font-size: 1.2rem !important;
        margin-bottom: 5px !important;
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
      }

      .shorts-info p {
        color: rgba(255,255,255,0.8) !important;
        font-size: 0.9rem !important;
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
      }

      .shorts-actions {
        display: flex !important;
        gap: 15px !important;
        margin-top: 15px !important;
        justify-content: center !important;
        visibility: visible !important;
        opacity: 1 !important;
        z-index: 10000 !important;
      }

      .action-btn {
        width: 50px !important;
        height: 50px !important;
        border-radius: 50% !important;
        border: none !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        cursor: pointer !important;
        transition: all 0.3s ease !important;
        background: transparent !important;
        padding: 0 !important;
        margin: 0 !important;
        position: relative !important;
        z-index: 10001 !important;
        visibility: visible !important;
        opacity: 1 !important;
      }

      .action-btn input[type="submit"] {
        width: 100% !important;
        height: 100% !important;
        border: none !important;
        background: transparent !important;
        color: white !important;
        cursor: pointer !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        padding: 0 !important;
        margin: 0 !important;
        font-size: 0 !important;
        line-height: 0 !important;
      }

      .action-btn.dislike {
        background: rgba(255,0,0,0.8) !important;
        color: white !important;
        border: none !important;
      }

      .action-btn.like {
        background: rgba(138,43,226,0.8) !important;
        color: white !important;
        border: none !important;
      }

      .action-btn:hover {
        transform: scale(1.1) !important;
      }

      .action-icon {
        width: 24px !important;
        height: 24px !important;
        color: white !important;
      }

      .action-btn.dislike .action-icon {
        stroke: white !important;
        stroke-width: 2.5 !important;
      }

      .action-btn.like .action-icon {
        fill: white !important;
      }
      
      .shorts-player {
        width: 100vw !important;
        height: 100vh !important;
        height: 100dvh !important;
        height: 100svh !important;
        height: 100lvh !important;
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        z-index: 99999 !important;
        overflow: hidden !important;
        background: #000 !important;
        border-radius: 0 !important;
        box-shadow: none !important;
        max-width: none !important;
        max-height: none !important;
        margin: 0 !important;
        padding: 0 !important;
        transform: translateZ(0) !important;
        will-change: transform !important;
        touch-action: none !important;
        -webkit-touch-callout: none !important;
        -webkit-tap-highlight-color: transparent !important;
      }
      
      .shorts-end {
        width: 100vw !important;
        height: 100vh !important;
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        z-index: 99999 !important;
        margin: 0 !important;
        padding: 0 !important;
        border-radius: 0 !important;
        box-shadow: none !important;
        max-width: none !important;
        max-height: none !important;
        background: #000 !important;
        display: flex !important;
        justify-content: center !important;
        align-items: center !important;
      }
      
      /* Override Tailwind et autres frameworks */
      .min-h-screen, .max-w-6xl, .mx-auto, .px-4, .sm\\:px-6, .lg\\:px-8, .py-4, .sm\\:py-0 {
        width: 100vw !important;
        height: 100vh !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 0 !important;
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        z-index: 99999 !important;
      }
      
      /* Styles pour mobile - masquer les barres de navigation */
      @supports (-webkit-touch-callout: none) {
        html, body {
          height: -webkit-fill-available !important;
        }
        
        .shorts-container,
        .shorts-player,
        .shorts-end,
        .results-container,
        .reward-results-container,
        .new-game-container,
        .play-container {
          height: -webkit-fill-available !important;
        }
      }
      
      /* Masquer les barres de navigation sur iOS */
      @media screen and (max-width: 768px) {
        html, body {
          height: 100vh !important;
          height: calc(var(--vh, 1vh) * 100) !important;
        }
        
        .shorts-container,
        .shorts-player,
        .shorts-end,
        .results-container,
        .reward-results-container,
        .new-game-container,
        .play-container {
          height: 100vh !important;
          height: calc(var(--vh, 1vh) * 100) !important;
        }
      }
      
      /* Masquer les éléments de debug et développement */
      .debug, .development, .rails, .turbo {
        display: none !important;
      }
    </style>
  </head>

  <body>
    <%= yield %>
    
    <!-- Ligne de référence pour marquer la limite de l'URL -->
    <div class="url-limit-line"></div>
    
    <script>
      // Solution ULTRA-AGRESSIVE pour forcer le plein écran sur mobile
      (function() {
        // Fonction pour calculer la vraie hauteur de l'écran
        function getTrueScreenHeight() {
          const methods = [
            () => window.screen.height,
            () => window.screen.availHeight,
            () => window.outerHeight,
            () => window.innerHeight + (window.outerHeight - window.innerHeight),
            () => document.documentElement.clientHeight,
            () => document.body.clientHeight
          ];
          
          let maxHeight = 0;
          methods.forEach(method => {
            try {
              const height = method();
              if (height > maxHeight) maxHeight = height;
            } catch (e) {}
          });
          
          return maxHeight || window.innerHeight;
        }
        
        // Fonction pour forcer le plein écran
        function forceFullscreen() {
          const trueHeight = getTrueScreenHeight();
          const trueWidth = window.screen.width || window.innerWidth;
          
          // Forcer les styles sur html et body
        document.documentElement.style.cssText = `
            width: ${trueWidth}px !important;
          height: ${trueHeight}px !important; 
          overflow: hidden !important; 
          background: #000 !important; 
          margin: 0 !important; 
          padding: 0 !important; 
          position: fixed !important; 
          top: 0 !important; 
          left: 0 !important; 
          z-index: 99999 !important;
        `;
        
        document.body.style.cssText = `
            width: ${trueWidth}px !important;
          height: ${trueHeight}px !important; 
          overflow: hidden !important; 
          background: #000 !important; 
          color: white !important; 
          margin: 0 !important; 
          padding: 0 !important; 
          position: fixed !important; 
          top: 0 !important; 
          left: 0 !important; 
          z-index: 99999 !important;
          touch-action: none !important;
        `;
        
          // Forcer les styles sur les conteneurs
          const containers = document.querySelectorAll('.shorts-container, .shorts-player, .shorts-end, .results-container, .reward-results-container, .new-game-container, .play-container');
        containers.forEach(container => {
          container.style.cssText = `
              width: ${trueWidth}px !important;
            height: ${trueHeight}px !important; 
            position: fixed !important; 
            top: 0 !important; 
            left: 0 !important; 
            right: 0 !important;
            bottom: 0 !important;
            z-index: 99999 !important; 
            margin: 0 !important; 
            padding: 0 !important; 
            border-radius: 0 !important; 
            box-shadow: none !important; 
            max-width: none !important; 
            max-height: none !important; 
            background: #000 !important;
              transform: translateZ(0) !important;
              will-change: transform !important;
            touch-action: none !important;
          `;
        });
        
        // Masquer tous les éléments de navigation
          const hideElements = ['nav', '.nav', '.main-content', '.flash', 'header', 'footer'];
        hideElements.forEach(selector => {
          const elements = document.querySelectorAll(selector);
          elements.forEach(el => {
            el.style.cssText = 'display: none !important; visibility: hidden !important; opacity: 0 !important; height: 0 !important; width: 0 !important; margin: 0 !important; padding: 0 !important;';
          });
        });
        }
        
        // Fonction pour forcer les styles de l'iframe
        function forceIframeStyles() {
          const allIframes = document.querySelectorAll('iframe[src*="youtube"]');
          allIframes.forEach(function(iframe) {
            if (iframe) {
              iframe.style.setProperty('width', '100vw', 'important');
              iframe.style.setProperty('height', 'calc(100svh - var(--bottom-gap))', 'important');
              iframe.style.setProperty('height', 'calc(100dvh - var(--bottom-gap))', 'important');
              iframe.style.setProperty('height', 'calc(100vh - var(--bottom-gap))', 'important');
              iframe.style.setProperty('position', 'fixed', 'important');
              iframe.style.setProperty('top', '0', 'important');
              iframe.style.setProperty('left', '0', 'important');
              iframe.style.setProperty('right', '0', 'important');
              iframe.style.setProperty('bottom', 'var(--bottom-gap)', 'important');
              iframe.style.setProperty('border', 'none', 'important');
              iframe.style.setProperty('margin', '0', 'important');
              iframe.style.setProperty('padding', '0', 'important');
              iframe.style.setProperty('max-width', 'none', 'important');
              iframe.style.setProperty('max-height', 'calc(100svh - var(--bottom-gap))', 'important');
              iframe.style.setProperty('max-height', 'calc(100dvh - var(--bottom-gap))', 'important');
              iframe.style.setProperty('max-height', 'calc(100vh - var(--bottom-gap))', 'important');
              iframe.style.setProperty('min-width', '100vw', 'important');
              iframe.style.setProperty('min-height', 'calc(100svh - var(--bottom-gap))', 'important');
              iframe.style.setProperty('min-height', 'calc(100dvh - var(--bottom-gap))', 'important');
              iframe.style.setProperty('min-height', 'calc(100vh - var(--bottom-gap))', 'important');
              iframe.style.setProperty('transform', 'scale(2)', 'important');
              iframe.style.setProperty('z-index', '1', 'important');
              iframe.style.setProperty('display', 'block', 'important');
              iframe.style.setProperty('visibility', 'visible', 'important');
              iframe.style.setProperty('opacity', '1', 'important');
            }
          });
          
          const videoContainer = document.querySelector('.shorts-video');
          if (videoContainer) {
            videoContainer.style.setProperty('width', '100vw', 'important');
            videoContainer.style.setProperty('height', 'calc(100svh - var(--bottom-gap))', 'important');
            videoContainer.style.setProperty('height', 'calc(100dvh - var(--bottom-gap))', 'important');
            videoContainer.style.setProperty('height', 'calc(100vh - var(--bottom-gap))', 'important');
            videoContainer.style.setProperty('position', 'fixed', 'important');
            videoContainer.style.setProperty('top', '0', 'important');
            videoContainer.style.setProperty('left', '0', 'important');
            videoContainer.style.setProperty('right', '0', 'important');
            videoContainer.style.setProperty('bottom', 'var(--bottom-gap)', 'important');
            videoContainer.style.setProperty('overflow', 'hidden', 'important');
            videoContainer.style.setProperty('z-index', '1', 'important');
          }
        }
        
        // Masquer les barres de navigation avec scroll
        function hideBrowserBars() {
          window.scrollTo(0, 1);
        }
        
        // Appliquer immédiatement
        forceFullscreen();
        forceIframeStyles();
        hideBrowserBars();
        
        // Variable pour stocker la limite calculée une seule fois
        let backgroundDivLimit = null;
        
        // Fonction pour détecter la div background et ajuster la limite (une seule fois)
        function adjustToBackgroundDiv() {
          // Si déjà calculé, ne pas refaire
          if (backgroundDivLimit !== null) return backgroundDivLimit;
          
          const backgroundDiv = document.querySelector('div[data-v-0473de6c].background');
          if (backgroundDiv) {
            const rect = backgroundDiv.getBoundingClientRect();
            backgroundDivLimit = window.innerHeight - rect.bottom;
            
            console.log('Background div found, limit set to:', backgroundDivLimit);
            
            // Appliquer la limite une seule fois
            const allIframes = document.querySelectorAll('iframe[src*="youtube"]');
            allIframes.forEach(function(iframe) {
              if (iframe) {
                iframe.style.setProperty('bottom', `${backgroundDivLimit}px`, 'important');
                iframe.style.setProperty('max-height', `calc(100vh - ${backgroundDivLimit}px)`, 'important');
              }
            });
            
            const controls = document.querySelector('.shorts-controls');
            if (controls) {
              controls.style.setProperty('bottom', `${backgroundDivLimit}px`, 'important');
            }
            
            return backgroundDivLimit;
          }
          return null;
        }
        
        // Fonction pour forcer la visibilité des contrôles
        function forceControlsVisibility() {
          const controls = document.querySelector('.shorts-controls');
          const actions = document.querySelector('.shorts-actions');
          const buttons = document.querySelectorAll('.action-btn');
          
          console.log('Debug controls:', { controls, actions, buttons: buttons.length });
          
          // Debug plus détaillé
          if (controls) {
            console.log('Controls found:', controls);
            console.log('Controls computed style:', window.getComputedStyle(controls));
          }
          if (actions) {
            console.log('Actions found:', actions);
            console.log('Actions computed style:', window.getComputedStyle(actions));
          }
          buttons.forEach((btn, index) => {
            console.log(`Button ${index}:`, btn);
            console.log(`Button ${index} computed style:`, window.getComputedStyle(btn));
          });
          
          if (controls) {
            controls.style.cssText = `
              position: fixed !important;
              bottom: 60px !important;
              left: 0 !important;
              right: 0 !important;
              background: linear-gradient(transparent, rgba(0,0,0,0.8)) !important;
              padding: 20px !important;
              z-index: 9999 !important;
              display: block !important;
              visibility: visible !important;
              opacity: 1 !important;
              pointer-events: auto !important;
              transform: translateZ(0) !important;
              border: 2px solid yellow !important;
            `;
          }
          
          if (actions) {
            actions.style.cssText = `
              display: flex !important;
              gap: 15px !important;
              margin-top: 15px !important;
              justify-content: center !important;
              visibility: visible !important;
              opacity: 1 !important;
              z-index: 10000 !important;
              position: relative !important;
              border: 2px solid red !important;
            `;
          }
          
          buttons.forEach((btn, index) => {
            console.log(`Button ${index}:`, btn);
            const isLike = btn.classList.contains('like');
            const isDislike = btn.classList.contains('dislike');
            
            btn.style.cssText = `
              width: 50px !important;
              height: 50px !important;
              border-radius: 50% !important;
              border: none !important;
              display: flex !important;
              align-items: center !important;
              justify-content: center !important;
              cursor: pointer !important;
              transition: all 0.3s ease !important;
              background: ${isLike ? 'rgba(138,43,226,0.8)' : 'rgba(255,0,0,0.8)'} !important;
              padding: 0 !important;
              margin: 0 !important;
              position: relative !important;
              z-index: 10001 !important;
              visibility: visible !important;
              opacity: 1 !important;
              transform: translateZ(0) !important;
            `;
            
            // Forcer aussi les styles sur les inputs submit
            const submitInput = btn.querySelector('input[type="submit"]');
            if (submitInput) {
              submitInput.style.cssText = `
                width: 100% !important;
                height: 100% !important;
                border: none !important;
                background: transparent !important;
                color: white !important;
                cursor: pointer !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                padding: 0 !important;
                margin: 0 !important;
                font-size: 0 !important;
                line-height: 0 !important;
                z-index: 10002 !important;
              `;
            }
          });
          
          // Si aucun bouton trouvé, créer des boutons de test
          if (buttons.length === 0) {
            console.log('Aucun bouton trouvé, création de boutons de test');
            if (actions) {
              actions.innerHTML = `
                <button class="action-btn dislike" style="background: red !important; border: 3px solid yellow !important; width: 50px !important; height: 50px !important; border-radius: 50% !important; z-index: 1002 !important;">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5">
                    <path d="M18 6L6 18M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
                <button class="action-btn like" style="background: green !important; border: 3px solid yellow !important; width: 50px !important; height: 50px !important; border-radius: 50% !important; z-index: 1002 !important;">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
                    <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                  </svg>
                </button>
              `;
            }
          }
        }
        
        // Appliquer au chargement du DOM
        document.addEventListener('DOMContentLoaded', function() {
          forceFullscreen();
          forceIframeStyles();
          hideBrowserBars();
          forceControlsVisibility();
          adjustToBackgroundDiv();
          
          // Observer les changements sur l'iframe
          const iframe = document.querySelector('iframe');
          if (iframe) {
            const observer = new MutationObserver(function(mutations) {
              mutations.forEach(function(mutation) {
                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                  setTimeout(forceIframeStyles, 10);
                }
              });
            });
            
            observer.observe(iframe, {
              attributes: true,
              attributeFilter: ['style']
            });
          }
        });
        
        // Appliquer en continu toutes les 50ms (sans forcer constamment)
        setInterval(function() {
          forceFullscreen();
          forceIframeStyles();
          forceControlsVisibility();
          // Ne pas appeler adjustToBackgroundDiv constamment
        }, 50);
        
        // Masquer les barres du navigateur
        setInterval(hideBrowserBars, 2000);
        
        // Maintenir le plein écran en continu
        setInterval(function() {
          forceFullscreen();
          forceIframeStyles();
          forceControlsVisibility();
          // Ne pas appeler adjustToBackgroundDiv constamment
        }, 500);
        
        // Forcer les styles de l'iframe encore plus fréquemment
      setInterval(function() {
          forceIframeStyles();
          forceControlsVisibility();
          // Ne pas appeler adjustToBackgroundDiv constamment
        }, 1);
        
        // Appliquer sur tous les événements de redimensionnement
        ['resize', 'orientationchange', 'focus', 'blur'].forEach(event => {
          window.addEventListener(event, function() {
            forceFullscreen();
            forceIframeStyles();
            hideBrowserBars();
            forceControlsVisibility();
            // Réinitialiser la limite sur resize pour recalculer
            backgroundDivLimit = null;
            adjustToBackgroundDiv();
          });
        });
        
      })();
    </script>
  </body>
</html>
