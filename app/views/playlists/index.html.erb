<div class="min-h-screen bg-gray-900 py-8">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- En-t√™te avec logo -->
    <div class="text-center mb-12">
      <div class="flex items-center justify-center mb-6">
        <div class="w-16 h-16 bg-gray-800 rounded-full flex items-center justify-center">
          <div class="w-8 h-8 text-cyan-400">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path d="M8 5.14v14l11-7-11-7z"/>
            </svg>
          </div>
        </div>
        <h1 class="text-4xl font-bold text-white ml-4">Playlists</h1>
      </div>
      <p class="text-gray-300 max-w-2xl mx-auto">
        D√©couvrez notre s√©lection de playlists musicales et votez pour vos chansons pr√©f√©r√©es.
      </p>
    </div>

    <!-- Boutons de filtrage -->
    <div class="flex justify-center mb-8">
      <div class="bg-gray-800 rounded-lg p-1 flex space-x-1">
        <button id="all-playlists-btn" class="filter-btn active px-6 py-2 rounded-md text-sm font-medium transition-all duration-200" data-filter="all">
          Toutes les playlists
        </button>
        <% if user_signed_in? %>
          <button id="my-playlists-btn" class="filter-btn px-6 py-2 rounded-md text-sm font-medium transition-all duration-200" data-filter="my">
            Mes playlists
          </button>
        <% end %>
      </div>
    </div>

    <!-- Tags de cat√©gories -->
    <div id="categories-section" class="mb-12">
      <h2 class="text-2xl font-bold text-white mb-6 text-center">üéµ Par Cat√©gorie</h2>
        <% categories = ['Pop', 'Rap', 'Afro Music', 'Hits', 'Electro', 'Rock'] %>
      <div class="categories-grid mb-8">
        <% ['Pop', 'Rap', 'Afro Music', 'Hits', 'Electro', 'Rock'].each do |category| %>
          <button class="category-tag px-4 py-4 rounded-xl text-sm font-medium transition-all duration-200 bg-gray-800 text-gray-300 hover:bg-gray-700 hover:text-white border border-gray-700 hover:border-gray-600" data-category="<%= category %>">
              <%= category %>
            </button>
        <% end %>
      </div>
      
      <!-- Affichage par cat√©gorie (toutes les playlists) -->
      <% categories.each do |category| %>
        <% category_playlists = (@standard_playlists + @premium_playlists + @unlocked_playlists).select { |p| p.category == category } %>
        <% if category_playlists.any? %>
          <div class="category-section mb-12" data-category="<%= category %>" style="display: block;">
            <h3 class="text-xl font-bold text-white mb-6"><%= category %></h3>
            <div class="playlists-grid">
              <% category_playlists.each do |playlist| %>
                <%= render 'playlist_card', playlist: playlist %>
              <% end %>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>

    <!-- Notification -->
    <% if flash[:alert] %>
      <div class="bg-red-500 text-white p-4 rounded-lg mb-8 max-w-2xl mx-auto">
        <%= flash[:alert] %>
      </div>
    <% end %>
    <% if flash[:notice] || params[:notice] %>
      <div class="bg-green-500 text-white p-4 rounded-lg mb-8 max-w-2xl mx-auto flex flex-col items-center gap-4">
        <span><%= flash[:notice] || params[:notice] %></span>
      </div>
    <% end %>

    <!-- Section playlists premium -->
    <% if (@unlocked_playlists + @premium_playlists).uniq.any? %>
      <div id="premium-section" class="mb-20 sm:mb-24 playlist-section">
        <h2 class="text-2xl font-bold text-white mb-6 border-b border-gray-800 pb-2">
          <span class="bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-pink-600">Playlists Premium</span>
          <span class="text-sm font-normal text-gray-400 ml-2">500 points requis</span>
        </h2>
        
        <div class="playlists-grid">
          <% (@unlocked_playlists + @premium_playlists).uniq.each do |playlist| %>
            <%= render 'playlist_card', playlist: playlist %>
          <% end %>
        </div>
      </div>
    <% end %>

    <!-- Section playlists exclusives -->
    <% if (@unlocked_exclusive_playlists + @exclusive_playlists).any? %>
      <div id="exclusive-section" class="mb-20 sm:mb-24 playlist-section">
        <h2 class="text-2xl font-bold text-white mb-6 border-b border-gray-800 pb-2">
          <span class="bg-clip-text text-transparent bg-gradient-to-r from-yellow-400 to-orange-600">Playlists Exclusives</span>
          <span class="text-sm font-normal text-gray-400 ml-2">R√©serv√©es aux r√©compenses</span>
        </h2>
        
        <div class="playlists-grid">
          <% (@unlocked_exclusive_playlists + @exclusive_playlists).each do |playlist| %>
            <%= render 'playlist_card', playlist: playlist %>
          <% end %>
        </div>
      </div>
    <% end %>

    <!-- Section playlists standard -->
    <div id="standard-section" class="mb-20 sm:mb-24 playlist-section">
      <h2 class="text-2xl font-bold text-white mb-6 border-b border-gray-800 pb-2">Playlists Standard</h2>
      <div class="playlists-grid">
        <% @standard_playlists.each do |playlist| %>
          <%= render 'playlist_card', playlist: playlist %>
        <% end %>
      </div>
    </div>

    <!-- Section mes playlists (si connect√©) -->
    <% if user_signed_in? && @user_playlists&.any? %>
      <div id="my-playlists-section" class="mb-16 playlist-section" style="display: none;">
        <h2 class="text-2xl font-bold text-white mb-6 border-b border-gray-800 pb-2">Mes Playlists</h2>
        
        <!-- Tags de cat√©gories pour Mes Playlists -->
        <div class="mb-6">
          <h3 class="text-lg font-bold text-white mb-4 text-center">üéµ Filtrer par Cat√©gorie</h3>
          <div class="categories-grid mb-6">
            <% categories.each do |category| %>
              <button class="my-category-filter category-tag px-4 py-4 rounded-xl text-sm font-medium transition-all duration-200 bg-gray-800 text-gray-300 hover:bg-gray-700 hover:text-white border border-gray-700 hover:border-gray-600" data-my-category="<%= category %>">
                <%= category %>
              </button>
            <% end %>
          </div>
        </div>
        
        <div class="playlists-grid">
          <% @user_playlists.each do |playlist| %>
            <div class="my-playlist-item" data-category="<%= playlist.category || 'Other' %>">
              <%= render 'playlist_card', playlist: playlist %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>

<style>
  @keyframes gradient {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  /* Styles pour les z-index personnalis√©s */
  .z-45 {
    z-index: 45 !important;
  }
  
  .z-50 {
    z-index: 50 !important;
  }
  
  .z-60 {
    z-index: 60 !important;
  }
  
  .z-70 {
    z-index: 70 !important;
  }
  
  /* Style pour les boutons Jouer */
  .play-button {
    position: absolute;
    bottom: 1rem;
    left: 50%;
    transform: translateX(-50%);
    z-index: 50 !important;
    background: linear-gradient(to right, #2563eb, #7c3aed);
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    font-weight: 600;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    transition: all 0.2s;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }
  
  .play-button:hover {
    background: linear-gradient(to right, #1d4ed8, #6d28d9);
    transform: translateX(-50%) scale(1.05);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
  }
  
  /* Style pour les liens cliquables */
  .clickable-card {
    position: absolute;
    inset: 0;
    z-index: 40;
    cursor: pointer;
    background: transparent;
    border: none;
    outline: none;
  }
  
  .clickable-card:hover {
    background: rgba(255, 255, 255, 0.05);
  }
  
  /* Styles pour les boutons de filtrage */
  .filter-btn {
    color: #9ca3af;
    background: transparent;
  }
  
  .filter-btn:hover {
    color: #ffffff;
    background: rgba(255, 255, 255, 0.1);
  }
  
  .filter-btn.active {
    color: #ffffff;
    background: #3b82f6;
  }
  
  /* Styles pour les tags de cat√©gories */
.categories-grid {
  display: grid !important;
  grid-template-columns: repeat(3, 1fr) !important;
  grid-template-rows: repeat(2, 1fr) !important;
  gap: 12px !important;
  width: 100% !important;
}

  .category-tag {
    transition: all 0.2s ease-in-out;
    min-height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
  width: 100% !important;
  }
  
  .category-tag:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
  }

/* Styles pour la grille des playlists 2 colonnes */
.playlists-grid {
  display: grid !important;
  grid-template-columns: repeat(2, 1fr) !important;
  gap: 16px !important;
  width: 100% !important;
}

.playlist-item {
  width: 100% !important;
}

/* Styles uniformes pour toutes les cartes de playlists */
.playlist-card-uniform {
  height: 320px !important;
  width: 100% !important;
  display: flex !important;
  flex-direction: column !important;
  background: #1f2937 !important;
  border-radius: 12px !important;
  overflow: hidden !important;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1) !important;
  transition: all 0.3s ease !important;
  position: relative !important;
}

.playlist-card-uniform:hover {
  transform: translateY(-4px) !important;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2) !important;
}

/* Section image uniforme */
.playlist-image-uniform {
  height: 180px !important;
  width: 100% !important;
  position: relative !important;
  overflow: hidden !important;
  background: #374151 !important;
}

.playlist-image-uniform img {
  width: 100% !important;
  height: 100% !important;
  object-fit: cover !important;
  object-position: center !important;
}

/* Section texte uniforme */
.playlist-text-uniform {
  height: 140px !important;
  padding: 16px !important;
  display: flex !important;
  flex-direction: column !important;
  justify-content: space-between !important;
  background: #1f2937 !important;
}

/* Titre uniforme */
.playlist-title-uniform {
  font-size: 14px !important;
  font-weight: 600 !important;
  color: white !important;
  line-height: 1.3 !important;
  margin-bottom: 8px !important;
  display: -webkit-box !important;
  -webkit-line-clamp: 2 !important;
  -webkit-box-orient: vertical !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  height: 36px !important;
}

/* Tags uniformes */
.playlist-tags-uniform {
  display: flex !important;
  flex-wrap: wrap !important;
  gap: 4px !important;
  margin-bottom: 8px !important;
  min-height: 24px !important;
}

.playlist-tag-uniform {
  font-size: 10px !important;
  font-weight: 500 !important;
  padding: 2px 6px !important;
  border-radius: 4px !important;
  text-transform: uppercase !important;
  letter-spacing: 0.5px !important;
}

/* Description uniforme */
.playlist-description-uniform {
  font-size: 12px !important;
  color: #9ca3af !important;
  line-height: 1.4 !important;
  display: -webkit-box !important;
  -webkit-line-clamp: 2 !important;
  -webkit-box-orient: vertical !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  height: 32px !important;
  margin-bottom: 8px !important;
}

/* Footer uniforme */
.playlist-footer-uniform {
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  font-size: 11px !important;
  color: #6b7280 !important;
}

/* Overlay premium uniforme */
.playlist-overlay-uniform {
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  background: rgba(0, 0, 0, 0.4) !important;
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  justify-content: center !important;
  z-index: 20 !important;
  border-radius: 12px !important;
}

.playlist-overlay-uniform svg {
  width: 32px !important;
  height: 32px !important;
  color: #9ca3af !important;
  margin-bottom: 8px !important;
}

.playlist-overlay-uniform .overlay-title {
  font-size: 14px !important;
  font-weight: 600 !important;
  color: white !important;
  margin-bottom: 4px !important;
}

.playlist-overlay-uniform .overlay-subtitle {
  font-size: 12px !important;
  color: #9ca3af !important;
  }
  
  .category-section {
    transition: all 0.3s ease-in-out;
  }
  
  /* Styles pour les filtres Mes Playlists */
  .my-category-filter {
    transition: all 0.2s ease-in-out;
  }
  
  .my-category-filter:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }
  
  /* Am√©lioration du design des cartes */
  .playlist-card-new-layout {
    min-height: 280px;
  }
  
  .playlist-image-section {
    min-height: 168px; /* 60% de 280px */
  }
  
  .playlist-text-section {
    min-height: 112px; /* 40% de 280px */
  }
  
  /* Styles pour uniformiser les images */
  .playlist-image {
    width: 100% !important;
    height: 100% !important;
    object-fit: cover !important;
    object-position: center !important;
  }
  
  .playlist-card-image-container {
    width: 100% !important;
    height: 100% !important;
    overflow: hidden !important;
    position: relative !important;
  }
  
  /* Styles pour garantir la visibilit√© des textes */
  .playlist-text-content {
    z-index: 80 !important;
    position: relative !important;
  }
  
  .playlist-text-content h3 {
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8) !important;
  }
  
  .playlist-text-content p {
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8) !important;
  }
  
  /* Nouvelle structure pour s√©parer image et texte */
  .playlist-card-new-layout {
    display: flex !important;
    flex-direction: column !important;
    height: 100% !important;
  }
  
  .playlist-image-section {
    flex: 0 0 60% !important;
    position: relative !important;
    overflow: hidden !important;
  }
  
  .playlist-text-section {
    flex: 0 0 40% !important;
    background: #1f2937 !important;
    padding: 1rem !important;
    display: flex !important;
    flex-direction: column !important;
    justify-content: space-between !important;
  }
  
  .playlist-text-section h3 {
    color: white !important;
    font-weight: bold !important;
    margin-bottom: 0.5rem !important;
  }
  
  .playlist-text-section p {
    color: #d1d5db !important;
    font-size: 0.875rem !important;
    line-height: 1.25rem !important;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const filterButtons = document.querySelectorAll('.filter-btn');
    const playlistSections = document.querySelectorAll('.playlist-section');
    const categoryTags = document.querySelectorAll('.category-tag');
    const categorySections = document.querySelectorAll('.category-section');
    const categoriesSection = document.getElementById('categories-section');

  // Initialiser l'affichage par d√©faut
  playlistSections.forEach(section => {
    if (section.id !== 'my-playlists-section') {
      section.style.display = 'block';
    }
  });

  if (categoriesSection) {
    categoriesSection.style.display = 'block';
  }
    
    // Gestion des boutons de filtrage
    filterButtons.forEach(button => {
      button.addEventListener('click', function() {
        const filter = this.getAttribute('data-filter');
        
        // Mettre √† jour les boutons
        filterButtons.forEach(btn => btn.classList.remove('active'));
        this.classList.add('active');
        
        // Filtrer les sections
        playlistSections.forEach(section => {
          if (filter === 'all') {
            // Afficher toutes les sections sauf "Mes playlists"
            if (section.id === 'my-playlists-section') {
              section.style.display = 'none';
            } else {
              section.style.display = 'block';
            }
          } else if (filter === 'my') {
            // Afficher seulement "Mes playlists"
            if (section.id === 'my-playlists-section') {
              section.style.display = 'block';
            } else {
              section.style.display = 'none';
            }
          }
        });
        
        // Masquer les cat√©gories quand on est sur "Mes playlists"
        if (filter === 'my') {
          categoriesSection.style.display = 'none';
        } else {
          categoriesSection.style.display = 'block';
        }
      });
    });
    
    // Gestion des tags de cat√©gories
    categoryTags.forEach(tag => {
      tag.addEventListener('click', function() {
        const category = this.getAttribute('data-category');
        
        // Mettre √† jour les tags
        categoryTags.forEach(t => t.classList.remove('bg-cyan-600', 'text-white'));
        categoryTags.forEach(t => t.classList.add('bg-gray-800', 'text-gray-300'));
        this.classList.remove('bg-gray-800', 'text-gray-300');
        this.classList.add('bg-cyan-600', 'text-white');
        
        // Afficher seulement la cat√©gorie s√©lectionn√©e
        categorySections.forEach(section => {
          if (section.getAttribute('data-category') === category) {
            section.style.display = 'block';
          } else {
            section.style.display = 'none';
          }
        });
        
        // Masquer les autres sections
        playlistSections.forEach(section => {
          section.style.display = 'none';
        });
      });
    });
    
    // Gestion des filtres dans "Mes Playlists"
    const myCategoryFilters = document.querySelectorAll('.my-category-filter');
    const myPlaylistItems = document.querySelectorAll('.my-playlist-item');
    
    myCategoryFilters.forEach(filter => {
      filter.addEventListener('click', function() {
        const category = this.getAttribute('data-my-category');
        
        // Mettre √† jour les filtres
        myCategoryFilters.forEach(f => f.classList.remove('bg-cyan-600', 'text-white'));
      myCategoryFilters.forEach(f => f.classList.add('bg-gray-800', 'text-gray-300'));
      this.classList.remove('bg-gray-800', 'text-gray-300');
        this.classList.add('bg-cyan-600', 'text-white');
        
        // Filtrer les playlists
        myPlaylistItems.forEach(item => {
          if (category === 'all' || item.getAttribute('data-category') === category) {
            item.style.display = 'block';
          } else {
            item.style.display = 'none';
          }
        });
      });
    });
  });
</script>
