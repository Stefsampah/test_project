<div class="min-h-screen bg-gray-900 py-0">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- En-t√™te -->
    <div class="text-center mb-4">
      <h1 class="text-2xl font-bold text-white"><%= @badge.name %></h1>
    </div>

    <!-- Badge Card -->
    <div class="bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg p-8 mb-8 transform hover:scale-105 transition-all duration-300">
      <div class="text-center">
        <div class="flex items-center justify-center mb-6">
          <% if @badge.image.present? %>
            <%= image_tag @badge.image_path, class: "w-24 h-24 rounded-full border-4 border-white/30" %>
          <% else %>
            <div class="w-24 h-24 rounded-full border-4 border-white/30 bg-gray-700 flex items-center justify-center">
              <svg class="w-12 h-12 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
              </svg>
            </div>
          <% end %>
        </div>
        
        <h2 class="text-3xl font-light text-white mb-4"><%= @badge.description %></h2>
        
        <!-- Niveau et type -->
        <div class="flex items-center justify-center gap-4 mb-6">
          <span class="bg-<%= @badge.level == 'gold' ? 'yellow' : (@badge.level == 'silver' ? 'gray' : 'amber') %>-600 text-white px-4 py-2 rounded-full font-semibold">
            <%= @badge.level.capitalize %>
          </span>
          <span class="bg-<%= @badge.badge_type == 'competitor' ? 'amber' : (@badge.badge_type == 'engager' ? 'blue' : (@badge.badge_type == 'critic' ? 'red' : 'purple')) %>-600 text-white px-4 py-2 rounded-full font-semibold">
            <%= @badge.badge_type.capitalize %>
          </span>
        </div>

        <!-- Conditions -->
        <div class="bg-white/10 rounded-lg p-6 mb-6">
          <h3 class="text-xl font-bold text-white mb-4">Conditions requises</h3>
          
          <% if @badge.condition_1_type.present? %>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <!-- Condition 1 -->
              <div class="bg-white/10 rounded-lg p-4">
                <div class="flex items-center justify-center mb-2">
                  <svg class="w-6 h-6 text-green-400" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                  </svg>
                </div>
                <h4 class="text-lg font-semibold text-white text-center"><%= @badge.condition_1_type.humanize %></h4>
                <p class="text-2xl font-bold text-green-400 text-center"><%= @badge.condition_1_value %></p>
                <% if user_signed_in? %>
                  <% current_value = case @badge.condition_1_type
                                     when 'regularity_points' then current_user.regularity_points
                                     when 'listening_points' then current_user.listening_points
                                     when 'critical_opinions' then current_user.critical_opinions_points
                                     when 'total_points' then current_user.total_points
                                     else 0
                                     end %>
                  <p class="text-sm text-white/80 text-center">
                    Votre progression: <%= current_value %>/<%= @badge.condition_1_value %>
                  </p>
                <% end %>
              </div>

              <!-- Condition 2 -->
              <% if @badge.condition_2_type.present? %>
                <div class="bg-white/10 rounded-lg p-4">
                  <div class="flex items-center justify-center mb-2">
                    <svg class="w-6 h-6 text-blue-400" fill="currentColor" viewBox="0 0 20 20">
                      <path d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"/>
                    </svg>
                  </div>
                  <h4 class="text-lg font-semibold text-white text-center"><%= @badge.condition_2_type.humanize %></h4>
                  <p class="text-2xl font-bold text-blue-400 text-center"><%= @badge.condition_2_value %></p>
                  <% if user_signed_in? %>
                    <% current_value = case @badge.condition_2_type
                                       when 'regularity_points' then current_user.regularity_points
                                       when 'listening_points' then current_user.listening_points
                                       when 'critical_opinions' then current_user.critical_opinions_points
                                       when 'total_points' then current_user.total_points
                                       else 0
                                       end %>
                    <p class="text-sm text-white/80 text-center">
                      Votre progression: <%= current_value %>/<%= @badge.condition_2_value %>
                    </p>
                  <% end %>
                </div>
              <% end %>

              <!-- Condition 3 -->
              <% if @badge.condition_3_type.present? %>
                <div class="bg-white/10 rounded-lg p-4">
                  <div class="flex items-center justify-center mb-2">
                    <svg class="w-6 h-6 text-purple-400" fill="currentColor" viewBox="0 0 20 20">
                      <path d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"/>
                    </svg>
                  </div>
                  <h4 class="text-lg font-semibold text-white text-center"><%= @badge.condition_3_type.humanize %></h4>
                  <p class="text-2xl font-bold text-purple-400 text-center"><%= @badge.condition_3_value %></p>
                  <% if user_signed_in? %>
                    <% current_value = case @badge.condition_3_type
                                       when 'regularity_points' then current_user.regularity_points
                                       when 'listening_points' then current_user.listening_points
                                       when 'critical_opinions' then current_user.critical_opinions_points
                                       when 'total_points' then current_user.total_points
                                       else 0
                                       end %>
                    <p class="text-sm text-white/80 text-center">
                      Votre progression: <%= current_value %>/<%= @badge.condition_3_value %>
                    </p>
                  <% end %>
                </div>
              <% end %>
            </div>
          <% else %>
            <!-- Fallback vers l'ancien syst√®me -->
            <div class="text-center">
              <p class="text-xl text-white mb-2">Points requis</p>
              <p class="text-3xl font-bold text-yellow-400"><%= @badge.points_required %></p>
              <% if user_signed_in? %>
                <% current_score = case @badge.badge_type
                                   when 'competitor' then current_user.total_points
                                   when 'engager' then current_user.listening_points + current_user.critical_opinions_points
                                   when 'critic' then current_user.critical_opinions_points
                                   when 'challenger' then current_user.total_points
                                   end %>
                <p class="text-sm text-white/80">
                  Votre progression: <%= current_score %>/<%= @badge.points_required %>
                </p>
              <% end %>
            </div>
          <% end %>
        </div>

        <!-- Syst√®me de r√©compenses -->
        <div class="bg-white/10 rounded-lg p-6">
          <h3 class="text-xl font-bold text-white mb-4">üèÜ Syst√®me de R√©compenses</h3>
          <div class="text-center mb-4">
            <p class="text-gray-300 text-sm mb-4">Ce badge contribue au syst√®me de r√©compenses bas√© sur le total de badges collect√©s :</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
              <div class="bg-gradient-to-r from-yellow-500/20 to-yellow-600/20 p-3 rounded-lg">
                <div class="text-yellow-300 font-semibold mb-1">ü•â 3 badges</div>
                <div class="text-gray-300">Challenge</div>
                <div class="text-xs text-gray-400">Playlists sp√©ciales</div>
              </div>
              
              <div class="bg-gradient-to-r from-gray-400/20 to-gray-500/20 p-3 rounded-lg">
                <div class="text-gray-300 font-semibold mb-1">ü•à 6 badges</div>
                <div class="text-gray-300">Exclusif</div>
                <div class="text-xs text-gray-400">Contenu exclusif</div>
              </div>
              
              <div class="bg-gradient-to-r from-orange-500/20 to-orange-600/20 p-3 rounded-lg">
                <div class="text-orange-300 font-semibold mb-1">ü•â 9 badges</div>
                <div class="text-gray-300">Premium</div>
                <div class="text-xs text-gray-400">Backstage virtuel</div>
              </div>
              
              <div class="bg-gradient-to-r from-pink-500/20 to-purple-600/20 p-3 rounded-lg">
                <div class="text-pink-300 font-semibold mb-1">üåà 12 badges</div>
                <div class="text-gray-300">Ultime</div>
                <div class="text-xs text-gray-400">Collection arc-en-ciel</div>
              </div>
            </div>
          </div>
          
          <% if user_signed_in? %>
            <div class="mt-4 p-3 bg-blue-500/20 rounded-lg">
              <div class="text-center">
                <div class="text-blue-300 font-semibold mb-1">Votre progression globale</div>
                <div class="text-white text-lg"><%= current_user.user_badges.count %> badges collect√©s</div>
                <div class="text-xs text-gray-400 mt-1">
                  <% next_reward = case current_user.user_badges.count
                                  when 0..2 then "3 badges pour Challenge"
                                  when 3..5 then "6 badges pour Exclusif"
                                  when 6..8 then "9 badges pour Premium"
                                  when 9..11 then "12 badges pour Ultime"
                                  else "Toutes les r√©compenses d√©bloqu√©es !"
                                  end %>
                  Prochaine r√©compense : <%= next_reward %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>

    <!-- Actions -->
    <div class="flex flex-col sm:flex-row justify-center items-center gap-4">
      <%= link_to badges_path, 
          class: "inline-flex items-center px-8 py-4 text-lg font-medium rounded-full text-white bg-white/20 hover:bg-white/30 transition-all focus:outline-none transform hover:scale-105" do %>
        <span>Retour aux badges</span>
        <svg class="ml-2 w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
      <% end %>
    </div>
<style>
  /* Harmonisation des titres principaux */
  h1.text-2xl.font-bold.text-white {
    font-size: 1.5rem !important;
    font-weight: 700 !important;
    line-height: 1.2 !important;
  }
</style>